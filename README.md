# Banana AI 이미지 에디터

> AI로 이미지를 만들고, **원하는 부분만** 편집하는 웹 애플리케이션

---

## 이 프로젝트를 만든 이유

### "이 차트에서 이 부분만 수정하고 싶은데..."

AI로 멋진 차트를 생성했습니다. 레이아웃도 완벽하고, 레이블도 깔끔합니다.
그런데 클라이언트가 **"3분기 막대만 빨간색으로 바꿔달라"**고 합니다.

프롬프트에 수정 요청을 추가하면?
**전체 차트가 새로 생성되면서 마음에 들었던 다른 요소들까지 바뀌어버립니다.**

이런 경험, 한 번쯤 있으시죠?

기존 AI 이미지 편집의 한계는 명확했습니다:
> "전체를 다시 생성하거나, 아예 손대지 않거나"

**부분 수정이라는 중간 지점이 없었습니다.**

제안서, PPT 등 디테일한 작업에 AI 이미지를 활용하기 위해서는 이 문제를 반드시 해결해야 했습니다.
저희 팀에서는 이 질문에 답하기 위해 **마스킹 기반 부분 편집 기술**을 개발했습니다.

그 결과물이 바로 **'바나나 에디터(Banana Editor)'** 입니다.

---

## 이 프로그램은 무엇인가요?

**Banana AI 이미지 에디터**는 텍스트(문장)만 입력하면 AI가 자동으로 이미지를 만들어주는 프로그램입니다.

예를 들어:
- "파란 하늘 아래 노란 꽃밭" 이라고 입력하면 → AI가 해당 이미지를 생성
- 기존 사진에서 "배경을 바다로 바꿔줘" 라고 입력하면 → AI가 배경만 수정

**포토샵이나 디자인 기술이 없어도** 누구나 쉽게 이미지를 만들고 수정할 수 있습니다.

---

## 주요 기능

### 1. 이미지 생성 (Generate)
텍스트로 원하는 이미지를 설명하면 AI가 새로운 이미지를 만들어줍니다.

**사용 예시:**
- "귀여운 고양이가 소파에서 자고 있는 모습"
- "미래 도시의 야경, 네온 조명"
- "수채화 스타일의 벚꽃 나무"

### 2. 이미지 편집 (Edit)
기존 이미지를 업로드하고, 원하는 수정 사항을 텍스트로 입력하면 AI가 수정해줍니다.

**사용 예시:**
- "이 사람의 머리색을 빨간색으로 바꿔줘"
- "배경을 흐리게 처리해줘"
- "하늘에 무지개를 추가해줘"

### 3. 마스크 선택 (Select) - 핵심 기능!
이미지에서 **특정 부분만** 수정하고 싶을 때 사용합니다.
브러시로 수정할 영역을 칠한 후 편집 명령을 입력하면, 칠한 부분만 수정됩니다.

**사용 예시:**
- 사람 얼굴 부분만 칠하고 → "선글라스를 씌워줘"
- 하늘 부분만 칠하고 → "석양으로 바꿔줘"
- 차트의 막대 하나만 칠하고 → "빨간색으로 바꿔줘"

### 4. 배경 제거 (누끼)
사진에서 배경을 자동으로 제거하고 주요 피사체만 남깁니다.
쇼핑몰 상품 사진이나 프로필 사진 편집에 유용합니다.

### 5. 참조 이미지
원하는 스타일의 이미지를 참조 이미지로 업로드하면, AI가 해당 스타일을 반영하여 생성합니다.

### 6. 프롬프트 빌더
비즈니스 시각화에 특화된 프롬프트 빌더를 제공합니다.
차트 유형, 색상 체계, 컨설팅 프레임워크 등을 클릭만으로 선택하면 AI가 이해하기 좋은 프롬프트가 자동으로 조합됩니다.

**팀 전체가 일관된 스타일의 시각화를 만들 수 있도록 돕는 기능입니다.**

---

## 마스킹 편집 사용 방법

바나나 에디터의 핵심 기능인 **마스킹 편집**을 단계별로 설명합니다.

### Step 1: 이미지 업로드
수정하고 싶은 차트나 다이어그램을 캔버스에 불러옵니다.

### Step 2: 선택 모드 전환
**'Select'** 버튼을 클릭하면 브러시 도구가 활성화됩니다.

### Step 3: 영역 칠하기
수정하고 싶은 부분을 브러시로 칠합니다.
- 칠한 영역은 **보라색 오버레이**로 표시되어 어디를 선택했는지 직관적으로 확인할 수 있습니다
- 브러시 크기는 5px ~ 50px까지 조절 가능
- 넓은 영역도, 세밀한 부분도 모두 커버 가능

### Step 4: 변경 지시
**'Edit'** 모드로 전환 후, 자연어로 수정 사항을 입력합니다.
- 예: "이 부분을 빨간색으로 바꿔줘"
- 예: "여기에 그림자 효과를 추가해줘"

### Step 5: 부분 편집 완료
AI가 **칠한 영역만 수정**하고, 나머지는 그대로 유지합니다!

---

## 기술 이야기: 어떻게 부분 편집이 가능할까?

### 이중 마스크 시스템

이 기능이 가능한 이유는 **이중 마스크 시스템** 덕분입니다.

사용자가 브러시로 칠하면, 시스템은 **두 개의 마스크**를 동시에 생성합니다:

| 구분 | 시각적 마스크 (Visual Mask) | 이진 마스크 (Binary Mask) |
|------|---------------------------|-------------------------|
| 용도 | 사용자에게 선택 영역을 보여줌 | AI 모델에게 전달 |
| 형태 | 보라색 반투명 오버레이 | 흰색/검은색으로만 구성 |
| 특징 | 캔버스에 실시간 렌더링 | 정확한 영역 경계 정보 포함 |

AI 모델은 이진 마스크를 보고 명확한 지시를 받습니다:
> "흰색 픽셀 영역만 수정하고, 검은색 픽셀 영역은 절대 건드리지 마라"

### 좌표 변환 시스템

캔버스를 확대하거나 축소해도 마스킹이 정확하게 동작합니다.

```
화면에서 클릭한 위치 → 캔버스 줌/팬 보정 → 실제 이미지 픽셀 좌표
```

화면 좌표를 이미지 좌표로 변환하는 정밀한 계산이 뒤에서 작동합니다.
덕분에 **100% 줌이든 30% 줌이든**, 사용자가 칠한 곳이 정확히 마스크에 반영됩니다.

---

## 개발 여정: 도전과 해결

### 도전 1: 마스크 경계의 자연스러움

가장 큰 도전은 **편집된 영역과 원본 영역의 경계를 자연스럽게 만드는 것**이었습니다.

단순히 마스크 영역만 잘라서 붙이면 경계가 어색해집니다.

**해결책:**
AI에게 "마스크 경계에서 자연스럽게 블렌딩하라"는 지시를 프롬프트에 포함시켰습니다:

```
"Apply changes ONLY where the mask image shows white pixels.
Leave all other areas completely unchanged.
Maintain seamless blending at the edges."
```

### 도전 2: AI의 맥락 이해

원본 이미지와 이진 마스크만 보내면 AI가 맥락을 잘 이해하지 못하는 경우가 있었습니다.

**해결책: 마스크 참조 이미지의 발견**

"보라색으로 칠해진 영역이 수정 대상"이라는 것을 **시각적으로 보여주는 참조 이미지**를 추가했습니다.

마스크 오버레이가 적용된 원본 이미지를 AI에게 함께 전달하니, 정확도가 크게 향상되었습니다!

### 그 순간

어느 날 밤, 복잡한 차트에서 **하나의 막대만 정확히 색상이 바뀌는 것**을 확인했을 때...

> "드디어 됐다!"

라고 외쳤던 순간은 잊을 수 없습니다.

---

## 시작하기 전에 준비할 것

### 1. Node.js 설치
Node.js는 이 프로그램을 실행하기 위해 필요한 소프트웨어입니다.

1. [Node.js 공식 사이트](https://nodejs.org/ko) 접속
2. **LTS 버전** (왼쪽 버튼) 다운로드
3. 설치 파일 실행 → "다음" 계속 클릭하여 설치 완료

### 2. Google AI API 키 발급
AI 기능을 사용하려면 Google에서 제공하는 API 키가 필요합니다 (무료).

1. [Google AI Studio](https://aistudio.google.com/) 접속
2. Google 계정으로 로그인
3. 왼쪽 메뉴에서 "API 키 만들기" 클릭
4. 생성된 키를 복사해서 안전한 곳에 저장

---

## 설치 방법

### 1단계: 프로젝트 다운로드
터미널(맥) 또는 명령 프롬프트(윈도우)를 열고 다음 명령어를 입력합니다:

```bash
git clone https://github.com/merryAI-dev/image_editor.git
cd image_editor
```

> **터미널 여는 방법:**
> - **맥**: Spotlight(Cmd + Space)에서 "터미널" 검색
> - **윈도우**: 시작 메뉴에서 "cmd" 검색

### 2단계: 필요한 파일 설치
```bash
npm install
```
이 명령어를 실행하면 프로그램에 필요한 파일들이 자동으로 다운로드됩니다.
(인터넷 속도에 따라 1~5분 소요)

### 3단계: API 키 설정
프로젝트 폴더에서 `.env.example` 파일을 찾아 `.env`로 이름을 변경합니다.

```bash
cp .env.example .env
```

그 다음 `.env` 파일을 텍스트 편집기로 열어서:
```
VITE_GEMINI_API_KEY=여기에_발급받은_API키_붙여넣기
```

### 4단계: 프로그램 실행
```bash
npm run dev
```

실행 후 터미널에 표시되는 주소(보통 `http://localhost:5173`)를
웹 브라우저(크롬, 사파리 등)에 입력하면 프로그램이 열립니다.

---

## 사용 방법

### 이미지 생성하기

1. 화면 상단에서 **"Generate"** 탭 선택
2. 텍스트 입력창에 원하는 이미지를 설명
   - 예: "숲 속의 작은 오두막집, 따뜻한 조명이 새어나오는"
3. **"Generate"** 버튼 클릭 (또는 Ctrl+Enter)
4. 잠시 기다리면 AI가 이미지를 생성

**팁:** 더 자세하게 설명할수록 원하는 결과를 얻기 쉽습니다.

### 이미지 편집하기

1. 화면 상단에서 **"Edit"** 탭 선택
2. 편집할 이미지를 드래그하여 업로드 (또는 이전에 생성한 이미지 선택)
3. 수정하고 싶은 내용을 텍스트로 입력
   - 예: "날씨를 눈 오는 겨울로 바꿔줘"
4. **"Apply Edit"** 버튼 클릭

### 특정 부분만 편집하기 (마스크)

1. **"Select"** 탭 선택
2. 브러시 크기 조절 (슬라이더 사용)
3. 수정하고 싶은 부분을 마우스로 칠하기
4. **"Edit"** 탭으로 이동
5. 수정 내용 입력 후 적용

---

## 키보드 단축키

| 단축키 | 기능 |
|--------|------|
| `Ctrl + Enter` | 생성/편집 실행 |
| `G` | 생성 모드로 전환 |
| `E` | 편집 모드로 전환 |
| `M` | 선택(마스크) 모드로 전환 |
| `H` | 히스토리 패널 열기/닫기 |

---

## 자주 묻는 질문 (FAQ)

### Q: API 키가 작동하지 않아요
**A:** 다음을 확인해주세요:
- `.env` 파일이 프로젝트 폴더 최상위에 있는지
- API 키 앞뒤에 공백이 없는지
- 키를 복사할 때 전체가 복사되었는지

### Q: 이미지가 생성되지 않아요
**A:** 가능한 원인:
- 인터넷 연결 확인
- API 사용량 한도 초과 (잠시 후 다시 시도)
- 부적절한 내용이 포함된 프롬프트 (정책 위반)

### Q: 원하는 대로 이미지가 나오지 않아요
**A:** 프롬프트 작성 팁:
- 더 구체적으로 설명하세요 (색상, 스타일, 분위기 등)
- 영어로 작성하면 더 정확한 결과를 얻을 수 있습니다
- 참조 이미지를 함께 업로드해보세요

### Q: 마스크 편집이 정확하지 않아요
**A:**
- 브러시로 영역을 더 정확하게 칠해보세요
- 브러시 크기를 조절해서 세밀하게 선택하세요
- 수정 지시를 더 구체적으로 작성해보세요

### Q: 프로그램이 느려요
**A:**
- 이미지 생성은 보통 10~30초 소요됩니다
- 브라우저 탭을 너무 많이 열어두면 느려질 수 있습니다

---

## 기술 스택

| 영역 | 기술 |
|------|------|
| 캔버스 렌더링 | Konva.js + React-Konva |
| AI 엔진 | Google Gemini 모델 |
| 상태 관리 | Zustand + React Query |
| 프레임워크 | React 18 + TypeScript + Vite |
| 스타일링 | Tailwind CSS |

특히 **Konva.js**는 브러시 스트로크의 실시간 렌더링과 좌표 변환에 핵심적인 역할을 합니다.

### 폴더 구조
```
src/
├── components/           # 화면 구성 요소
│   ├── canvas/          # 이미지 캔버스, 마스크 오버레이
│   ├── modals/          # 팝업 창
│   ├── prompt/          # 프롬프트 입력, 빌더, 제안
│   └── ui/              # 버튼, 입력창 등 기본 UI
├── hooks/               # 커스텀 훅 (이미지 생성/편집 로직)
├── services/            # Gemini API 통신
├── store/               # 전역 상태 관리
└── types/               # 타입 정의
```

---

## 앞으로의 비전

> "이 막대만 빨간색으로, 저 레이블만 볼드체로, 배경만 그라데이션으로..."

이런 세밀한 요청도 AI가 정확히 이해하는 미래.
상상만 해도 즐겁지 않나요?

**'바나나 에디터'를 시작으로, AI 이미지 편집의 실무 활용성을 한 단계 높여나갈 도전을 지켜봐 주시기 바랍니다.**

---

## 라이선스

이 프로젝트는 **AGPL-3.0** 라이선스를 따릅니다.

- 개인 및 상업적 용도로 자유롭게 사용 가능
- 수정한 경우 동일한 라이선스로 소스 코드 공개 필요
- 웹 서비스로 운영 시 소스 코드 공개 필요

자세한 내용은 [LICENSE](LICENSE) 파일을 참조하세요.

---

## Contributors

이 프로젝트에 기여해주신 분들입니다.

| | 이름 | GitHub |
|---|------|--------|
| 👨‍💻 | **Boram** | [@merryAI-dev](https://github.com/merryAI-dev) |
| 👨‍💻 | **Minwook** | [@Boram.minwook](https://github.com/Boram.minwook) |

---

## 문의 및 기여

버그 리포트나 기능 제안은 [GitHub Issues](https://github.com/merryAI-dev/image_editor/issues)에 등록해주세요.

기여를 원하시면 Pull Request를 보내주세요!

---

**Powered by Google Gemini AI**
